<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Deep Attestation - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:50%;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;text-decoration:none;padding-left:22px}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em;font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h2 id="Introduction" data-id="Introduction"><a class="anchor hidden-xs" href="#Introduction" title="Introduction"><span class="octicon octicon-link"></span></a><span>Introduction</span></h2><p><span>This document describes how to deploy and set up an architecture to run the demonstration of our Deep Attestation protocol. It can be runned on a single device provided that it is embedded with a TPM 2.0 and has virtualization capacities. All the instructions have been tested on Ubuntu Desktop 20.04.1.</span></p><h4 id="Architecture" data-id="Architecture"><a class="anchor hidden-xs" href="#Architecture" title="Architecture"><span class="octicon octicon-link"></span></a><span>Architecture</span></h4><p><span>The architecture we are going to describe is presented in the  picture below . The PC is used as the hypervisor using KVM and we run 2 QEMU Virtual machines over it. A third virtual machine played the role of the attestation server. The computer must be equipped with a TPM 2.0 (here an OPTIGA TPM by Infineon). To provide a TPM to the VM we are using a QEMU module by IBM. The communication with both the virtual TPM and hardware TPM is made with tools following the TCG TSS2 specifications. The attestation server also uses the tools as they provide functions to ease the attestation even if it does not have  a TPM.</span></p><p><img src="https://i.imgur.com/PItuyy2.png" alt=""></p><h2 id="Installation" data-id="Installation"><a class="anchor hidden-xs" href="#Installation" title="Installation"><span class="octicon octicon-link"></span></a><span>Installation</span></h2><h4 id="Hypervisor" data-id="Hypervisor"><a class="anchor hidden-xs" href="#Hypervisor" title="Hypervisor"><span class="octicon octicon-link"></span></a><span>Hypervisor</span></h4><h6 id="KVMQEMU-" data-id="KVMQEMU-"><a class="anchor hidden-xs" href="#KVMQEMU-" title="KVMQEMU-"><span class="octicon octicon-link"></span></a><span>KVM/QEMU :</span></h6><p><span>First we need to install QEMU and KVM. You can use these commands on Ubuntu :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span></div><div class="code">sudo apt install qemu-kvm virt-manager
sudo adduser `id -un` libvirt
</div></div></code></pre><p><span>To connect to the VM we use spice client but you can also use OpenSSH :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">sudo apt install spice-client-gtk
</div></div></code></pre><h6 id="Virtual-TPM" data-id="Virtual-TPM"><a class="anchor hidden-xs" href="#Virtual-TPM" title="Virtual-TPM"><span class="octicon octicon-link"></span></a><span>Virtual TPM</span></h6><p><span>Now we can install the virtual TPM module. You will need to compile it. If you have trouble you can refer to the Github page of </span><a href="https://github.com/stefanberger/libtpms" target="_blank" rel="noopener"><span>libtpms</span></a><span> and </span><a href="https://github.com/stefanberger/swtpm" target="_blank" rel="noopener"><span>swtpm</span></a><span>.</span></p><p><span>You will need the following dependencies :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">sudo apt install git build-essential autoconf libtool libssl-dev python3-pip pkg-config libtasn1-6-dev libgnutls28-dev expect gawk socat libseccomp-dev gnutls-bin
</div></div></code></pre><p><span>Install the emulation library :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span></div><div class="code">git <span class="hljs-built_in">clone</span> -b stable-0.7.0 --single-branch https://github.com/stefanberger/libtpms.git
<span class="hljs-built_in">cd</span> libtpms
./autogen.sh --with-openssl --with-tpm2
make
sudo make install
sudo ldconfig
<span class="hljs-built_in">cd</span> ..
</div></div></code></pre><p><span>and the front end emulator :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span></div><div class="code">git <span class="hljs-built_in">clone</span> -b stable-0.5 --single-branch https://github.com/stefanberger/swtpm.git
<span class="hljs-built_in">cd</span> swtpm
./autogen.sh --with-openssl --with-tpm2
make
sudo make install
<span class="hljs-built_in">cd</span> src/swtpm_setup
sudo python3 setup.py install
<span class="hljs-built_in">cd</span> ../../samples
sudo python3 setup.py install
sudo ldconfig
</div></div></code></pre><h6 id="TPM2-tools-" data-id="TPM2-tools-"><a class="anchor hidden-xs" href="#TPM2-tools-" title="TPM2-tools-"><span class="octicon octicon-link"></span></a><span>TPM2-tools :</span></h6><p><span>Finally, we can install the TPM communication tools. On Ubuntu there are precompiled packages so you can install these tools with the commands below. If you want more recent version or a customized installation refer to the Github page of the </span><a href="https://github.com/tpm2-software" target="_blank" rel="noopener"><span>project</span></a><span>.</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span></div><div class="code">sudo apt install tpm2-abrmd tpm2-tools tpm-udev
sudo adduser `id -un` tss
sudo udevadm control --reload-rules &amp;&amp; udevadm trigger
</div></div></code></pre><h6 id="Deep-Attestation-protocol" data-id="Deep-Attestation-protocol"><a class="anchor hidden-xs" href="#Deep-Attestation-protocol" title="Deep-Attestation-protocol"><span class="octicon octicon-link"></span></a><span>Deep Attestation protocol</span></h6><p><span>Create a folder in your home directoy. Inside this folder create a Server_Cert and a Temp folder. Then copy the files </span><code>hypervisor.py</code><span>, </span><code>hypervisor_attestation.py</code><span>, </span><code>tpm.py</code><span>, </span><code>utils.py</code><span> from the </span><code>src</code><span> directory and the </span><code>conf_hypervisor.json</code><span> file from the </span><code>config</code><span> folder.</span></p><pre><code>\DeepAttestation
...\Server_Cert
...\Temp
...hypervisor.py
...hypervisor_attestation.py
...tpm.py
...utils.py
...conf_hypervisor.json
</code></pre><h4 id="Virtual-Machines" data-id="Virtual-Machines"><a class="anchor hidden-xs" href="#Virtual-Machines" title="Virtual-Machines"><span class="octicon octicon-link"></span></a><span>Virtual Machines</span></h4><h6 id="TPM2-tools-1" data-id="TPM2-tools-"><a class="anchor hidden-xs" href="#TPM2-tools-1" title="TPM2-tools-1"><span class="octicon octicon-link"></span></a><span>TPM2-tools :</span></h6><p><span>On virtual machines we only need the TPM2-tools, you can install them in the same way that on the hypervisor.</span></p><h6 id="Deep-Attestation-protocol1" data-id="Deep-Attestation-protocol"><a class="anchor hidden-xs" href="#Deep-Attestation-protocol1" title="Deep-Attestation-protocol1"><span class="octicon octicon-link"></span></a><span>Deep Attestation protocol</span></h6><p><span>Follow the same procedure as installation on hypervisor but replace hypervisor python files by vm files. Same for the configuration file.</span></p><pre><code>\DeepAttestation
...\Server_Cert
...\Temp
...vm.py
...vm_attestation.py
...tpm.py
...utils.py
...conf_vm.json
</code></pre><h4 id="Attestation-server" data-id="Attestation-server"><a class="anchor hidden-xs" href="#Attestation-server" title="Attestation-server"><span class="octicon octicon-link"></span></a><span>Attestation server</span></h4><h6 id="TPM2-tools-2" data-id="TPM2-tools-"><a class="anchor hidden-xs" href="#TPM2-tools-2" title="TPM2-tools-2"><span class="octicon octicon-link"></span></a><span>TPM2-tools :</span></h6><p><span>We also need the TPM2-tools but without the access broker and resource Manager as there is no TPM.</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">sudo apt install tpm2-tools
</div></div></code></pre><h6 id="Deep-Attestation-protocol2" data-id="Deep-Attestation-protocol"><a class="anchor hidden-xs" href="#Deep-Attestation-protocol2" title="Deep-Attestation-protocol2"><span class="octicon octicon-link"></span></a><span>Deep Attestation protocol</span></h6><p><span>Same procedure as before but create two more folders : </span><code>Ref_PCR</code><span> and </span><code>TPM_Cert</code><span>.</span></p><pre><code>\DeepAttestation
...\Server_Cert
...\Temp
...\Ref_PCR
...\TPM_Cert
...server.py
...server_attestation.py
...tpm.py
...utils.py
...conf_server.json
</code></pre><h2 id="Set-Up" data-id="Set-Up"><a class="anchor hidden-xs" href="#Set-Up" title="Set-Up"><span class="octicon octicon-link"></span></a><span>Set Up</span></h2><p><span>In this section we describe how to launch the demonstration infrastructure as described in the diagram above. We provide scripts that you can also find in the setup folder on the GitHub repository.</span></p><h4 id="Create-vTPM" data-id="Create-vTPM"><a class="anchor hidden-xs" href="#Create-vTPM" title="Create-vTPM"><span class="octicon octicon-link"></span></a><span>Create vTPM</span></h4><p><span>The </span><code>create_tpm.py</code><span> script creates a vTPM at the given location (folder). Use this script to create 2 vTPM each of them in a specific folder regroup in one folder as in the example.</span></p><pre><code>\vTPM
...\tpm1
...\tpm2
</code></pre><p><span>Usage of </span><code>create_tpm.py</code><span> :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">python3 create_tpm.py ~/Documents/vTPM/tpm1/
</div></div></code></pre><h4 id="Launch-attestation-server-and-VM-with-virtual-TPM-module" data-id="Launch-attestation-server-and-VM-with-virtual-TPM-module"><a class="anchor hidden-xs" href="#Launch-attestation-server-and-VM-with-virtual-TPM-module" title="Launch-attestation-server-and-VM-with-virtual-TPM-module"><span class="octicon octicon-link"></span></a><span>Launch attestation server and VM with virtual TPM module</span></h4><p><span>First use </span><code>net_conf.sh</code><span> to create a virtual network connecting the VMs, the attestation server and the hypervisor together through a virtual bridge :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">bash ./net_conf 3 
</div></div></code></pre><p><span>The bridge provides a DHCP server but you can manually set the addresses of the VM and server in the range </span><code>192.168.100.50/192.168.100.254</code><span>. The hypervisor is always at address </span><code>192.168.100.1</code><span>.</span></p><p><span>Then you can boot the VM with </span><code>swtpm_runvm.sh</code><span>.</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">./swtpm_runvm.sh ~/Documents/vTPM/tpm0/ ~/Documents/VM/VM1.qcow2 5001 tap1
</div></div></code></pre><p><span>The first parameter is the location of the folder containing a vTPM created with </span><code>create_tpm.py</code><span>, the second the VM file, the third a port for a spice server in the VM and the last a virtual interface.</span></p><p><span>To boot the server use the </span><code>run_server.sh</code><span> which works the same but don’t need a vTPM.</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">./run_server.sh ~/Documents/VM/Server.qcow2 5000 tap0 
</div></div></code></pre><p><span>We can use spice client to connect to the machine with a graphical interface :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">spicy -h 127.0.0.1 -p 5000
</div></div></code></pre><h4 id="Generate-a-TLS-certificat-for-the-attestation-server" data-id="Generate-a-TLS-certificat-for-the-attestation-server"><a class="anchor hidden-xs" href="#Generate-a-TLS-certificat-for-the-attestation-server" title="Generate-a-TLS-certificat-for-the-attestation-server"><span class="octicon octicon-link"></span></a><span>Generate a TLS certificat for the attestation server</span></h4><p><span>To establish a TLS connection with the client we need a certificate. The commands below create a private RSA key and a self signed certificate. When running </span><code>openssl req</code><span> you will be prompted about information about the server. Only the Common Name field is important. You must enter the hostname of the attestation server (run </span><code>hostname</code><span> command on the attestation server to get the hostname) as the TLS implementation of python 3.8 and upper will reject certificate without a matching host (you also need to specify in the /etc/hosts file of the VMs and hypervisor the address and hostname of the attestation server unless you install a DNS server). Run the following commands inside the Server_Cert folder on the attestation server.</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span></div><div class="code">openssl genrsa -out server.orig.key 2048
openssl rsa -<span class="hljs-keyword">in</span> server.orig.key -out server.key
openssl req -new -key server.key -out server.csr
openssl x509 -req -days 365 -<span class="hljs-keyword">in</span> server.csr -signkey server.key -out server.crt
</div></div></code></pre><p><span>Copy the </span><code>server.crt</code><span> file in the </span><code>Server_Cert</code><span> folder created during the installation on the hypervisor and VM (you can use scp to copy files on other machine).</span></p><h4 id="Generates-reference-values-of-PCR" data-id="Generates-reference-values-of-PCR"><a class="anchor hidden-xs" href="#Generates-reference-values-of-PCR" title="Generates-reference-values-of-PCR"><span class="octicon octicon-link"></span></a><span>Generates reference values of PCR</span></h4><p><span>The attestation server needs to know the reference state of PCRs to verify that the current state of a VM or hypervisor PCRs and the reference PCRs match. To get those reference values you have to run the following commands.</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span></div><div class="code">tpm2_createek -c ek.handle
tpm2_createak -C ek.handle -c ak.handle
<span class="hljs-comment"># Replace 1,2,3 with PCRs you want to quote</span>
tpm2_quote -c ak.handle -l sha256:1,2,3 -o pcr.data
tpm2_flushcontext --transient-object
rm ek.handke ak.handle
</div></div></code></pre><p><span>The reference values are in the </span><code>pcr.data</code><span> file. Copy the pcr data files into the </span><code>Ref_PCR</code><span> folder of the attestation server.</span></p><h4 id="Get-root-EK-certificate-of-the-hardware-TPM" data-id="Get-root-EK-certificate-of-the-hardware-TPM"><a class="anchor hidden-xs" href="#Get-root-EK-certificate-of-the-hardware-TPM" title="Get-root-EK-certificate-of-the-hardware-TPM"><span class="octicon octicon-link"></span></a><span>Get root EK certificate of the hardware TPM</span></h4><p><span>To verify that attestation keys are associated with a real TPM, the attestation server needs to get the root certificate associated with the EK certificate of the hardware TPM. Here we give an example with a Nuvoton TPM.</span></p><p><span>First get EK certificate :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">tpm2_nvread 0x1c00002 &gt; ekcert.der
</div></div></code></pre><p><span>By reading the certificate you should find the URL address to download the root certificate :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">openssl x509 -inform der -<span class="hljs-keyword">in</span> ekcert.der -noout -text
</div></div></code></pre><p><span>Finally we download and convert the root certificate to PEM format :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span></div><div class="code">wget https://www.nuvoton.com/security/NTC-TPM-EK-Cert/Nuvoton\ TPM\ Root\ CA\ 2111.cer -O rootCA.der
openssl x509 -inform der -<span class="hljs-keyword">in</span> rootCA.der -out rootCA.pem
</div></div></code></pre><p><span>Copy the </span><code>rootCA.pem</code><span> file in the </span><code>TPM_Cert</code><span> folder on the attestation server.</span></p><h2 id="Configuration" data-id="Configuration"><a class="anchor hidden-xs" href="#Configuration" title="Configuration"><span class="octicon octicon-link"></span></a><span>Configuration</span></h2><p><span>In this section we describe how to use the configuration files. All the files are json files.</span></p><h4 id="Attestation-server1" data-id="Attestation-server"><a class="anchor hidden-xs" href="#Attestation-server1" title="Attestation-server1"><span class="octicon octicon-link"></span></a><span>Attestation server</span></h4><pre><code class="json hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span></div><div class="code"><span class="token punctuation">{</span>
    <span class="token property">"host"</span> <span class="token operator">:</span> <span class="token string">"server"</span><span class="token punctuation">,</span>
    <span class="token property">"port"</span> <span class="token operator">:</span> <span class="token number">4433</span><span class="token punctuation">,</span>
    <span class="token property">"server_cert"</span> <span class="token operator">:</span> <span class="token string">"Server_Cert/server.crt"</span><span class="token punctuation">,</span>
    <span class="token property">"server_key"</span> <span class="token operator">:</span> <span class="token string">"Server_Cert/server.key"</span><span class="token punctuation">,</span>
    <span class="token property">"tpm_ca"</span> <span class="token operator">:</span> <span class="token string">"TPM_CA/rootCA.pem"</span><span class="token punctuation">,</span>
    <span class="token property">"normal_pcr_hyp"</span> <span class="token operator">:</span> <span class="token string">"Normal_PCR/pcr_hyp.data"</span><span class="token punctuation">,</span>
    <span class="token property">"pcr_list_hyp"</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"normal_pcr_vm"</span> <span class="token operator">:</span> <span class="token string">"Normal_PCR/pcr_vm.data"</span><span class="token punctuation">,</span>
    <span class="token property">"pcr_list_vm"</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"working_dir"</span> <span class="token operator">:</span> <span class="token string">"Temp/"</span>
<span class="token punctuation">}</span>
</div></div></code></pre><p><code>host</code><span> : host name of the attestation server</span><br>
<code>port</code><span> : port for TLS server</span><br>
<code>server_cert</code><span> : path to attestation server TLS certificate</span><br>
<code>server_key</code><span> : path to attestation server TLS private key</span><br>
<code>tpm_ca</code><span> : path to hardware TPM root certificate</span><br>
<code>normal_pcr_hyp</code><span> : path to reference PCR data for hypervisor</span><br>
<code>pcr_list_hyp</code><span> : list of PCR to quote for hypervisor</span><br>
<code>normal_pcr_vm</code><span> : path to reference PCR data for virtual machine</span><br>
<code>pcr_list_vm</code><span> : list of PCR to quote for virtual machine</span><br>
<code>working_dir</code><span> : path to a folder that can be used to store temporary files (you can use the folder </span><code>Temp</code><span> created during the installation)</span></p><h4 id="Hypervisor1" data-id="Hypervisor"><a class="anchor hidden-xs" href="#Hypervisor1" title="Hypervisor1"><span class="octicon octicon-link"></span></a><span>Hypervisor</span></h4><pre><code class="json hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span></div><div class="code"><span class="token punctuation">{</span>
    <span class="token property">"host"</span> <span class="token operator">:</span> <span class="token string">"server"</span><span class="token punctuation">,</span>
    <span class="token property">"port"</span> <span class="token operator">:</span> <span class="token number">4433</span><span class="token punctuation">,</span>
    <span class="token property">"server_ca"</span> <span class="token operator">:</span> <span class="token string">"Server_Cert/server.crt"</span><span class="token punctuation">,</span>
    <span class="token property">"vTPM_folder_path"</span> <span class="token operator">:</span> <span class="token string">"vTPM/"</span><span class="token punctuation">,</span>
    <span class="token property">"aik_password"</span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token property">"working_dir"</span> <span class="token operator">:</span> <span class="token string">"Temp/"</span>
<span class="token punctuation">}</span>
</div></div></code></pre><p><code>host</code><span>, </span><code>port</code><span> and </span><code>working_dir</code><span> are the same as attestation server.</span></p><p><code>server_ca</code><span> : path to attestation server TLS certificate</span><br>
<code>vTPM_folder_path</code><span> : path to the folder containing the vTPM subfolders</span><br>
<code>aik_password</code><span> : not used you can leave empty</span></p><h4 id="Virtual-Machines1" data-id="Virtual-Machines"><a class="anchor hidden-xs" href="#Virtual-Machines1" title="Virtual-Machines1"><span class="octicon octicon-link"></span></a><span>Virtual Machines</span></h4><pre><code class="json hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span></div><div class="code"><span class="token punctuation">{</span>
    <span class="token property">"host"</span> <span class="token operator">:</span> <span class="token string">"server"</span><span class="token punctuation">,</span>
    <span class="token property">"port"</span> <span class="token operator">:</span> <span class="token number">4433</span><span class="token punctuation">,</span>
    <span class="token property">"server_ca"</span> <span class="token operator">:</span> <span class="token string">"Server_Cert/server.crt"</span><span class="token punctuation">,</span>
    <span class="token property">"aik_password"</span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token property">"working_dir"</span> <span class="token operator">:</span> <span class="token string">"Temp/"</span>
<span class="token punctuation">}</span>
</div></div></code></pre><p><span>Same as hypervisor but without vTPM field.</span></p><h2 id="Run-Protocol" data-id="Run-Protocol"><a class="anchor hidden-xs" href="#Run-Protocol" title="Run-Protocol"><span class="octicon octicon-link"></span></a><span>Run Protocol</span></h2><p><span>First run the attestation server :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">python3 server.py -c conf_server.json
</div></div></code></pre><p><span>then you can attest the hypervisor :</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">python3 hypervisor.py -c conf_hypervisor.json
</div></div></code></pre><p><span>and finally attest the virtual machines by running this on each VM:</span></p><pre><code class="bash hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code">python3 vm.py -c conf_vm.json
</div></div></code></pre></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Introduction" title="Introduction">Introduction</a><ul class="nav">
<li><a href="#Architecture" title="Architecture">Architecture</a></li>
</ul>
</li>
<li><a href="#Installation" title="Installation">Installation</a><ul class="nav">
<li><a href="#Hypervisor" title="Hypervisor">Hypervisor</a></li>
<li><a href="#Virtual-Machines" title="Virtual Machines">Virtual Machines</a></li>
<li><a href="#Attestation-server" title="Attestation server">Attestation server</a></li>
</ul>
</li>
<li><a href="#Set-Up" title="Set Up">Set Up</a><ul class="nav">
<li><a href="#Create-vTPM" title="Create vTPM">Create vTPM</a></li>
<li><a href="#Launch-attestation-server-and-VM-with-virtual-TPM-module" title="Launch attestation server and VM with virtual TPM module">Launch attestation server and VM with virtual TPM module</a></li>
<li><a href="#Generate-a-TLS-certificat-for-the-attestation-server" title="Generate a TLS certificat for the attestation server">Generate a TLS certificat for the attestation server</a></li>
<li><a href="#Generates-reference-values-of-PCR" title="Generates reference values of PCR">Generates reference values of PCR</a></li>
<li><a href="#Get-root-EK-certificate-of-the-hardware-TPM" title="Get root EK certificate of the hardware TPM">Get root EK certificate of the hardware TPM</a></li>
</ul>
</li>
<li><a href="#Configuration" title="Configuration">Configuration</a><ul class="nav">
<li><a href="#Attestation-server1" title="Attestation server">Attestation server</a></li>
<li><a href="#Hypervisor1" title="Hypervisor">Hypervisor</a></li>
<li><a href="#Virtual-Machines1" title="Virtual Machines">Virtual Machines</a></li>
</ul>
</li>
<li><a href="#Run-Protocol" title="Run Protocol">Run Protocol</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Introduction" title="Introduction">Introduction</a><ul class="nav">
<li><a href="#Architecture" title="Architecture">Architecture</a></li>
</ul>
</li>
<li><a href="#Installation" title="Installation">Installation</a><ul class="nav">
<li><a href="#Hypervisor" title="Hypervisor">Hypervisor</a></li>
<li><a href="#Virtual-Machines" title="Virtual Machines">Virtual Machines</a></li>
<li><a href="#Attestation-server" title="Attestation server">Attestation server</a></li>
</ul>
</li>
<li><a href="#Set-Up" title="Set Up">Set Up</a><ul class="nav">
<li><a href="#Create-vTPM" title="Create vTPM">Create vTPM</a></li>
<li><a href="#Launch-attestation-server-and-VM-with-virtual-TPM-module" title="Launch attestation server and VM with virtual TPM module">Launch attestation server and VM with virtual TPM module</a></li>
<li><a href="#Generate-a-TLS-certificat-for-the-attestation-server" title="Generate a TLS certificat for the attestation server">Generate a TLS certificat for the attestation server</a></li>
<li><a href="#Generates-reference-values-of-PCR" title="Generates reference values of PCR">Generates reference values of PCR</a></li>
<li><a href="#Get-root-EK-certificate-of-the-hardware-TPM" title="Get root EK certificate of the hardware TPM">Get root EK certificate of the hardware TPM</a></li>
</ul>
</li>
<li><a href="#Configuration" title="Configuration">Configuration</a><ul class="nav">
<li><a href="#Attestation-server1" title="Attestation server">Attestation server</a></li>
<li><a href="#Hypervisor1" title="Hypervisor">Hypervisor</a></li>
<li><a href="#Virtual-Machines1" title="Virtual Machines">Virtual Machines</a></li>
</ul>
</li>
<li><a href="#Run-Protocol" title="Run Protocol">Run Protocol</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
